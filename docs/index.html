<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.553">

  <meta name="author" content="Nicholas Tierney">
  <meta name="dcterms.date" content="2025-05-04">
  <title>Extendable projection of social contact matrices</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title"><strong>Extendable</strong> projection of social contact matrices</h1>
  <p class="subtitle">Telethon Kids Institute</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Nicholas Tierney 
</div>
        <p class="quarto-title-affiliation">
            Telethon Kids Institute
          </p>
    </div>
</div>

  <p class="date">2025-05-04</p>
</section>
<section id="what-this-talk-is-about" class="slide level2">
<h2>What this talk is about</h2>
<ul>
<li class="fragment"><p>Explain <strong>how</strong> I came to help write software for infectious disease modelling</p></li>
<li class="fragment"><p>Touch on the <strong>overall</strong> approach for methods. A large portion of my role was on software and interface design.</p></li>
<li class="fragment"><p>Discuss <strong>why</strong> we needed our own method + software design decisions</p></li>
<li class="fragment"><p>Advocate for contributions of <strong>software design + statistical thinking</strong>: <em>the way of the research software engineer</em>, so to speak.</p></li>
</ul>
</section>
<section id="the-story-so-far" class="slide level2">
<h2>The story so far</h2>
<ul>
<li class="fragment"><p>2008-2012: Undergrad + honours in Psychology @ UQ</p></li>
<li class="fragment"><p>2013 - 2017: PhD Statistics @ QUT</p>
<ul>
<li class="fragment">Exploratory Data Analysis (EDA)</li>
<li class="fragment">Bayesian / Geospatial statistics / Optimal placement</li>
</ul></li>
<li class="fragment"><p>2018 - 2020: Research Fellow / Lecturer @ Monash</p>
<ul>
<li class="fragment">Design and improve tools for EDA</li>
</ul></li>
<li class="fragment"><p>2020 - 2024: <strong>Research Software Engineer</strong> @ Telethon Kids Institute</p>
<ul>
<li class="fragment">Maintain and design tools for data analysis</li>
</ul></li>
</ul>
</section>
<section id="define-research-software-engineer" class="slide level2">
<h2>Define: Research Software Engineer</h2>
<blockquote>
<p>A Research Software Engineer (RSE) combines professional software engineering expertise with an intimate understanding of research.</p>
</blockquote>
<p>‚Äì (from https://society-rse.org/about/)</p>
</section>
<section id="what-sorts-of-things-does-an-rse-do" class="slide level2">
<h2>What sorts of things does an RSE do?</h2>
<ul>
<li class="fragment"><p>Create software to <strong>solve research problems</strong></p></li>
<li class="fragment"><p>Develop tools that <strong>abstract the right components</strong> to facilitate research</p></li>
<li class="fragment"><p>Help researchers to <strong>find and learn</strong> good tools</p></li>
<li class="fragment"><p>Support researchers with (computational) reproducibility</p></li>
<li class="fragment"><p>(adapted from Heidi Seibold‚Äôs <a href="https://docs.google.com/presentation/d/1XQc2U2X8hiK43UzUi9IwvsvULxhVy0WzWSa_Kt4ZJv4/view#slide=id.gdbfb32d486_0_448">UseR2021 Keynote talk</a>)</p></li>
</ul>
<aside class="notes">
<p>I bring this up because I feel a bit of a need to explain my background to help explain the context of what I do</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="visdatvis_datairquality" class="slide level2">
<h2><code>visdat::vis_dat(airquality)</code></h2>

<img data-src="index_files/figure-revealjs/show-visdat-1.png" width="768" class="r-stretch"></section>
<section id="naniargg_miss_upsetairquality" class="slide level2">
<h2><code>naniar::gg_miss_upset(airquality)</code></h2>

<img data-src="index_files/figure-revealjs/gg-miss-upset-1.png" width="768" class="r-stretch"></section>
<section id="brolgar---take-spaghetti" class="slide level2">
<h2><code>brolgar</code> - take spaghetti</h2>

<img data-src="index_files/figure-revealjs/gg-brolgar-1.png" width="960" class="r-stretch"></section>
<section id="brolgar---spread-spaghetti" class="slide level2">
<h2><code>brolgar</code> - spread spaghetti</h2>

<img data-src="index_files/figure-revealjs/gg-brolgar-spread-1.png" width="960" class="r-stretch"><aside class="notes">
<p>I‚Äôm a research software engineer, I help translate research methods into open source research software. One of my primary tasks is Extending/maintaining <code>greta</code> for statistical computing. I also work on creating and extending other software as needed for our team. Optional bits: PhD statistics - emphasis on frustration developing workflows R packages to facilitate exploratory data analysis Overviews, missing data, longitudinal data</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section" class="slide level2" data-background-image="images/greta-logo-background.png" data-background-size="contain">
<h2></h2>
<!-- Professor Nick Golding -->
<!-- [greta-stats.org](https://www.greta-stats.org) -->
</section>
<section id="greta-is-r-code" class="slide level2">
<h2>greta is R code</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><strong>stan</strong></p>
<pre><code>data {
  real alpha;
  real beta;
  real&lt;lower=0&gt; sigma2;
  int&lt;lower=0&gt; J;
  array[J] int y;
  vector[J] Z;
  array[J] int n;
}
transformed data {
  real&lt;lower=0&gt; sigma;
  sigma = sqrt(sigma2);
}
parameters {
  real theta1;
  real theta2;
  vector[J] X;
}
model {
  array[J] real p;
  theta1 ~ normal(0, 32); // 32^2 = 1024 
  theta2 ~ normal(0, 32);
  X ~ normal(alpha + beta * Z, sigma);
  y ~ binomial_logit(n, theta1 + theta2 * X);
}</code></pre>
</div><div class="column" style="width:55%;">
<p><strong>JAGS</strong></p>
<pre><code>for(j in 1 : J) {
   y[j] ~ dbin(p[j], n[j])
   logit(p[j]) &lt;- theta[1] + theta[2] * X[j]
   X[j] ~ dnorm(mu[j], tau)
   mu[j] &lt;- alpha + beta * Z[j]
}
theta[1] ~ dnorm(0.0, 0.001)
theta[2] ~ dnorm(0.0, 0.001)</code></pre>
<p><strong>greta</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>theta <span class="ot">&lt;-</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">32</span>, <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb3-2"><a href=""></a>mu <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> Z</span>
<span id="cb3-3"><a href=""></a>X <span class="ot">&lt;-</span> <span class="fu">normal</span>(mu, sigma)</span>
<span id="cb3-4"><a href=""></a>p <span class="ot">&lt;-</span> <span class="fu">ilogit</span>(theta[<span class="dv">1</span>] <span class="sc">+</span> theta[<span class="dv">2</span>] <span class="sc">*</span> X)</span>
<span id="cb3-5"><a href=""></a><span class="fu">distribution</span>(y) <span class="ot">&lt;-</span> <span class="fu">binomial</span>(n, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section>
<section id="google-tensorflow" class="title-slide slide level1 center">
<h1>google tensorflow</h1>
<div class="columns">
<div class="column" style="width:45%;">
<ul>
<li class="fragment">automatic differentiation</li>
<li class="fragment">efficient linear algebra</li>
<li class="fragment">highly parallel</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/tf-examples.png" width="200"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="extendable" class="slide level2">
<h2>extendable</h2>

<img data-src="images/greta-extendable.png" width="278" class="r-stretch"></section></section>
<section>
<section id="greta.gp" class="title-slide slide level1 center">
<h1><code>greta.gp</code></h1>
<blockquote>
<p>Extends <code>greta</code> to let you define Gaussian processes as part of your model. It provides a syntax to create and combine GP kernels, and use them to define either full rank or sparse Gaussian processes.</p>
</blockquote>
<div class="columns">
<div class="column" style="width:60%;">
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># kernel &amp; GP</span></span>
<span id="cb4-2"><a href=""></a>kernel <span class="ot">&lt;-</span> <span class="fu">rbf</span>(rbf_len, rbf_var) <span class="sc">+</span> </span>
<span id="cb4-3"><a href=""></a>            <span class="fu">bias</span>(<span class="dv">1</span>)</span>
<span id="cb4-4"><a href=""></a>f <span class="ot">&lt;-</span> <span class="fu">gp</span>(x, kernel)</span>
<span id="cb4-5"><a href=""></a><span class="co"># likelihood</span></span>
<span id="cb4-6"><a href=""></a><span class="fu">distribution</span>(y) <span class="ot">&lt;-</span> <span class="fu">normal</span>(f, obs_sd)</span>
<span id="cb4-7"><a href=""></a><span class="co"># prediction</span></span>
<span id="cb4-8"><a href=""></a>f_plot <span class="ot">&lt;-</span> <span class="fu">project</span>(f, x_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:38%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="images/greta-extendable-gp.png" width="1000"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="joining-an-infectious-disease-team" class="slide level2">
<h2>Joining an infectious disease team</h2>
<ul>
<li class="fragment"><p>August, 2021: Australia is working on the plan to reopen, part of ‚ÄúThe Doherty Report‚Äù</p></li>
<li class="fragment"><p>They need more hands to help with data analysis and software development</p></li>
<li class="fragment"><p>I joined to assist for ~4 months</p></li>
<li class="fragment"><p>Helped develop pipelines + software for disease modelling, establish code base for people to contribute</p></li>
</ul>
</section></section>
<section>
<section id="soliloquy" class="title-slide slide level1 center">
<h1>Soliloquy</h1>
<aside class="notes">
<p>I wanted to take a moment to talk about the dedication of this group of people. They worked tirelessly, and had been working tirelessly since March 2020. There were a heap of tight deadlines, and massive amounts of work that they graciously took on. It was a massive honour to work with all of these people.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="infectious-disease-modelling" class="slide level2">
<h2>Infectious Disease Modelling</h2>
<ul>
<li class="fragment">Diseases like COVID19 and Influenza spread through face to face social contact</li>
</ul>
<aside class="notes">
<ul>
<li>I think we‚Äôre all familiar enough with COVID to know what I mean here.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment"><p>Describe which 3 people had contact:</p>
<ul>
<li class="fragment"><p>James has had contact with Luke</p></li>
<li class="fragment"><p>Nick hasn‚Äôt had contact with either</p></li>
</ul></li>
</ul>
<aside class="notes">
<p>So say we have 3 people and we want to describe who have had face to face contact in the past week. Let‚Äôs take myself and my two brothers. They‚Äôre both in Brisbane and I‚Äôm not, so I haven‚Äôt seen them. We might say:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-visually" class="slide level2">
<h2>Example: visually</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"><aside class="notes">
<p>This shows whether people had contact, yes or no. We can see that everyone had contact with one another except for Nick, and with Nick. Note that we could change this from something logical - ‚Äúdid they have contact‚Äù to ‚Äúhow many times did you have contact?‚Äù</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="example-matrix" class="slide level2">
<h2>Example: matrix</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre style="font-size:170%;"><code>      James  Luke  Nick
James    NA  TRUE FALSE
Luke   TRUE    NA FALSE
Nick  FALSE FALSE    NA</code></pre>
</div>
</div>
</section>
<section id="logical-numeric" class="slide level2">
<h2>Logical ‚Äì&gt; Numeric</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"><aside class="notes">
<p>So now we have not just, ‚ÄúDid you have contact?‚Äù, but, ‚ÄúHow many times did you have contact?‚Äù Instead of individual people, we could change this to age groups.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="people-age-groups" class="slide level2">
<h2>People ‚Äì&gt; Age groups</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="what-do-you-do-with-this" class="slide level2">
<h2>What do you do with this?</h2>
<ul>
<li class="fragment"><p>If we know how many times people have contact, we have an idea of which age groups will spread COVID</p></li>
<li class="fragment"><p>Simulate how many COVID cases would get transmitted</p></li>
<li class="fragment"><p>Explore how vaccination reduces transmission</p></li>
<li class="fragment"><p>Do this for different areas in Australia</p></li>
</ul>
</section>
<section id="do-we-know-how-much-contact-people-have" class="slide level2">
<h2>Do we know how much contact people have?</h2>
<ul>
<li class="fragment"><p>We don‚Äôt. Well, not in Australia. Yet.</p></li>
<li class="fragment"><p>You need to conduct a surveys where people diary the amount and manner of daily contacts they have.</p></li>
<li class="fragment"><p><a href="https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0050074">Mossong et al</a> have this for 8 countries in Europe</p></li>
<li class="fragment"><p>Referred to as the <strong>POLYMOD</strong> study</p></li>
</ul>
<aside class="notes">
<ul>
<li>So we have a pretty good idea of the amount of contact people have in Europe.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="method-of-mossong-et-al" class="slide level2">
<h2>Method of Mossong et al</h2>
<ul>
<li class="fragment">Random weekday: record every person in contact with.</li>
<li class="fragment">Physical contact:
<ul>
<li class="fragment">skin-to-skin contact (kiss or handshake)</li>
</ul></li>
<li class="fragment">Non-physical contact:
<ul>
<li class="fragment">two-way conversation with 3+ words in physical presence of a person</li>
</ul></li>
</ul>
</section>
<section id="method-of-mossong-et-al-1" class="slide level2">
<h2>Method of Mossong et al</h2>
<ul>
<li class="fragment">Participants provide info on:
<ul>
<li class="fragment">age and sex of each contact person</li>
<li class="fragment">location (home, work, school, etc)</li>
<li class="fragment">time spent together</li>
<li class="fragment">frequency of usual contacts with this individual</li>
</ul></li>
</ul>
</section>
<section id="contact-surveys-are" class="slide level2">
<h2>Contact surveys are üí∞ üí∞ üí∞</h2>
<ul>
<li class="fragment">Part of why we don‚Äôt have them in Australia</li>
<li class="fragment">Can we get a contact matrix for a country not on the list?</li>
<li class="fragment">We need to have a best guess from existing surveys</li>
</ul>
</section>
<section id="synthetic-contact-matrices" class="slide level2">
<h2>Synthetic contact matrices</h2>
<ul>
<li class="fragment">Pre-existing statistical methodologies project empirical contact matrices to new countries.</li>
<li class="fragment">New projected contact matrices: ‚Äúsynthetic contact matrices‚Äù</li>
<li class="fragment">Use existing contact surveys (e.g., <strong>POLYMOD</strong>)</li>
<li class="fragment">Use setting-specific survey data on household, school, classroom, and workplace composition</li>
<li class="fragment">Combine with empirical data on contact patterns in Europe using statistical models</li>
</ul>
</section>
<section id="prem-et-al" class="slide level2">
<h2>Prem et al</h2>
<ul>
<li class="fragment">Prem et al.&nbsp;have one of the most widely used approaches to synthetic contact matrices</li>
<li class="fragment">Extensively applied across infectious diseases applications</li>
<li class="fragment">Initially provided 155 matrices for 155 countries (177 later in 2020)</li>
</ul>
</section>
<section id="brief-explainer-of-prem" class="slide level2">
<h2>Brief explainer of Prem</h2>
<ul>
<li class="fragment"><p><span class="math inline">\(X^{L}_{i,\alpha} \sim Poisson(\mu_{i, \alpha}^{L})\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(X^{L}_{i,\alpha}\)</span> is the number of contacts made by individual <span class="math inline">\(i\)</span> at a particular location <span class="math inline">\(L\)</span> with someone in age group <span class="math inline">\(\alpha\)</span> is modelled to be Poisson with mean <span class="math inline">\(\mu_{i, \alpha}^{L}\)</span>.</p></li>
<li class="fragment"><p>the ages of individual <span class="math inline">\(i\)</span>, <span class="math inline">\(\alpha_i\)</span>, and their contact, <span class="math inline">\(\alpha\)</span> are broken into 5 year age intervals</p></li>
<li class="fragment"><p><span class="math inline">\(L\)</span> is contact location: L = ‚Ä¶Home, Work, School, Other</p></li>
<li class="fragment"><p>Main thrust: Contact matrices are projected because the age distribution of population is included in <span class="math inline">\(\mu\)</span></p></li>
</ul>
</section>
<section id="core-ideas-of-prem" class="slide level2">
<h2>Core ideas of Prem</h2>
<ul>
<li class="fragment">Build a model from the POLYMOD study, predicting number of contacts</li>
<li class="fragment">Incorporate key age information for different locations (home, work, school, other)</li>
<li class="fragment">Extrapolate the number of contacts to different countries, using age information from those countries</li>
<li class="fragment">Create a new contact matrix for a given country</li>
</ul>
</section>
<section id="section-1" class="slide level2" data-background-image="images/prem-dir-mats.png" data-background-size="contain">
<h2></h2>
</section>
<section id="section-2" class="slide level2" data-background-image="images/prem-spreadsheet.png" data-background-size="contain">
<h2></h2>
<aside class="notes">
<p><strong>image of spreadsheet booklet of contact matrices</strong></p>
<p>The main issue with this is that we don‚Äôt have much control over the outputs.</p>
<p>And maybe that doesn‚Äôt matter to you if you just need to look at the contact matrices for a given country.</p>
<p>But what we needed to do is get contact matrices for a given age population structure.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="populations-are-different" class="slide level2">
<h2>Populations are different</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="populations-are-different-1" class="slide level2">
<h2>Populations are different</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="what-we-want" class="slide level2">
<h2>What we want</h2>
<ul>
<li class="fragment">We want to be able use a <strong>population age distribution</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>fairfield <span class="ot">&lt;-</span> <span class="fu">abs_age_lga</span>(<span class="st">"Fairfield (C)"</span>)</span>
<span id="cb6-2"><a href=""></a>fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 √ó 4 (conmat_population)
 - age: lower.age.limit
 - population: population
   lga           lower.age.limit  year population
   &lt;chr&gt;                   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 Fairfield (C)               0  2020      12261
 2 Fairfield (C)               5  2020      13093
 3 Fairfield (C)              10  2020      13602
 4 Fairfield (C)              15  2020      14323
 5 Fairfield (C)              20  2020      15932
 6 Fairfield (C)              25  2020      16190
 7 Fairfield (C)              30  2020      14134
 8 Fairfield (C)              35  2020      13034
 9 Fairfield (C)              40  2020      12217
10 Fairfield (C)              45  2020      13449
11 Fairfield (C)              50  2020      13419
12 Fairfield (C)              55  2020      13652
13 Fairfield (C)              60  2020      12907
14 Fairfield (C)              65  2020      10541
15 Fairfield (C)              70  2020       8227
16 Fairfield (C)              75  2020       5598
17 Fairfield (C)              80  2020       4006
18 Fairfield (C)              85  2020       4240</code></pre>
</div>
</div>
</section>
<section id="what-we-want-1" class="slide level2">
<h2>What we want</h2>
<ul>
<li class="fragment">Input <strong>population age distribution</strong> and get out a contact matrix.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">extrapolate_from_data</span>(</span>
<span id="cb8-2"><a href=""></a>  <span class="at">population =</span> fairfield</span>
<span id="cb8-3"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-do-we-extend-this-method" class="slide level2">
<h2>How do we extend this method?</h2>
<ul>
<li class="fragment"><p><a href="https://github.com/kieshaprem/synthetic-contact-matrices">Code is provided</a>, but a few key issues:</p>
<ul>
<li class="fragment"><p>It was code not written for reuse (code vs software)</p>
<ul>
<li class="fragment"><p>No clear interface on how to get inputs for a given country or region.</p></li>
<li class="fragment"><p>Challenging to see which bits of code matched which methods</p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>Australia was in original 155 countries, not in the new updated 177!</p></li>
</ul>
</section>
<section id="building-our-own-extension" class="slide level2">
<h2>Building our own extension</h2>
<ul>
<li class="fragment"><p>Nick Golding wrote a new method that was able to be more flexible, using Generalised Additive Models (GAMs) instead of Bayesian approach.</p></li>
<li class="fragment"><p>I was tasked with writing software from initial model fitting code, with guidance from Nick</p></li>
<li class="fragment"><p>Named the package, <code>conmat</code>, (<a href="https://github.com/njtierney/conmat">repo</a>), creating a home for code for others to contribute to.</p></li>
<li class="fragment"><p>In R package form, this made it easier for us to develop and extend software on demand for our needs</p></li>
</ul>
</section>
<section id="how-does-the-model-work" class="slide level2">
<h2>How does the model work?</h2>
<p>(simplified)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>mgcv<span class="sc">::</span><span class="fu">bam</span>(</span>
<span id="cb9-2"><a href=""></a>  <span class="at">formula =</span> contacts <span class="sc">~</span></span>
<span id="cb9-3"><a href=""></a>    <span class="co"># deviation of contact age distribution from population age distribution</span></span>
<span id="cb9-4"><a href=""></a>    <span class="fu">s</span>(age_to) <span class="sc">+</span></span>
<span id="cb9-5"><a href=""></a>    <span class="co"># number of contacts by age</span></span>
<span id="cb9-6"><a href=""></a>    <span class="fu">s</span>(age_from) <span class="sc">+</span></span>
<span id="cb9-7"><a href=""></a>    <span class="co"># intergenerational contact patterns - enables the off-diagonals</span></span>
<span id="cb9-8"><a href=""></a>    <span class="fu">s</span>(<span class="fu">abs</span>(age_from <span class="sc">-</span> age_to)) <span class="sc">+</span></span>
<span id="cb9-9"><a href=""></a>    <span class="co"># interaction between intergenerational patterns and age_from, to remove</span></span>
<span id="cb9-10"><a href=""></a>    <span class="co"># ridge for some ages and settings</span></span>
<span id="cb9-11"><a href=""></a>    <span class="fu">s</span>(<span class="fu">abs</span>(age_from <span class="sc">-</span> age_to), age_from) <span class="sc">+</span></span>
<span id="cb9-12"><a href=""></a>    <span class="co"># probabilities of both attending (any) school/work</span></span>
<span id="cb9-13"><a href=""></a>    school_probability <span class="sc">+</span></span>
<span id="cb9-14"><a href=""></a>    work_probability <span class="sc">+</span></span>
<span id="cb9-15"><a href=""></a>    <span class="fu">offset</span>(school_popn<span class="sc">/</span>work_popn),</span>
<span id="cb9-16"><a href=""></a>    <span class="at">family =</span> stats<span class="sc">::</span>poisson,</span>
<span id="cb9-17"><a href=""></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: the offset of participants allows us to get the rate per person</span></span>
<span id="cb9-18"><a href=""></a>    <span class="at">offset =</span> <span class="fu">log</span>(participants)</span>
<span id="cb9-19"><a href=""></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="demonstration-of-conmat" class="slide level2">
<h2>Demonstration of conmat</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">library</span>(conmat)</span>
<span id="cb10-2"><a href=""></a>fairfield <span class="ot">&lt;-</span> <span class="fu">abs_age_lga</span>(<span class="st">"Fairfield (C)"</span>)</span>
<span id="cb10-3"><a href=""></a>fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 √ó 4 (conmat_population)
 - age: lower.age.limit
 - population: population
   lga           lower.age.limit  year population
   &lt;chr&gt;                   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 Fairfield (C)               0  2020      12261
 2 Fairfield (C)               5  2020      13093
 3 Fairfield (C)              10  2020      13602
 4 Fairfield (C)              15  2020      14323
 5 Fairfield (C)              20  2020      15932
 6 Fairfield (C)              25  2020      16190
 7 Fairfield (C)              30  2020      14134
 8 Fairfield (C)              35  2020      13034
 9 Fairfield (C)              40  2020      12217
10 Fairfield (C)              45  2020      13449
11 Fairfield (C)              50  2020      13419
12 Fairfield (C)              55  2020      13652
13 Fairfield (C)              60  2020      12907
14 Fairfield (C)              65  2020      10541
15 Fairfield (C)              70  2020       8227
16 Fairfield (C)              75  2020       5598
17 Fairfield (C)              80  2020       4006
18 Fairfield (C)              85  2020       4240</code></pre>
</div>
</div>
</section>
<section id="extrapolate-to-a-new-population" class="slide level2">
<h2>Extrapolate to a new population</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>synthetic_fairfield <span class="ot">&lt;-</span> <span class="fu">extrapolate_polymod</span>(</span>
<span id="cb12-2"><a href=""></a> <span class="at">population =</span> fairfield,</span>
<span id="cb12-3"><a href=""></a> <span class="at">age_breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="cn">Inf</span>) <span class="co"># default</span></span>
<span id="cb12-4"><a href=""></a>)</span>
<span id="cb12-5"><a href=""></a>synthetic_fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contact-matrix-fairfield" class="slide level2">
<h2>Contact matrix: Fairfield</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">autoplot</span>(synthetic_fairfield<span class="sc">$</span>home)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/plot-matrix-fairfield-1.png" width="960" class="r-stretch"></section>
<section id="contact-matrix-australia" class="slide level2">
<h2>Contact matrix: Australia</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">autoplot</span>(synthetic_polymod_oz<span class="sc">$</span>home)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/plot-matrix-polymod-1.png" width="960" class="r-stretch"></section>
<section id="create-a-next-generation-matrix" class="slide level2">
<h2>Create A Next Generation Matrix</h2>
<ul>
<li class="fragment">Once infected, a person can transmit an infectious disease to another, creating <strong>generations</strong> of infected individuals.</li>
<li class="fragment">We can define a matrix describing the <strong>number of newly infected</strong> individuals in age groups, for consecutive generations.</li>
<li class="fragment">This matrix is called a <strong>next generation matrix</strong> (NGM).</li>
</ul>
</section>
<section id="create-a-next-generation-matrix-1" class="slide level2">
<h2>Create A Next Generation Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>ngm_fairfield <span class="ot">&lt;-</span> <span class="fu">generate_ngm</span>(</span>
<span id="cb15-2"><a href=""></a>  <span class="at">x =</span> synthetic_fairfield,</span>
<span id="cb15-3"><a href=""></a>  <span class="at">age_breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="cn">Inf</span>),</span>
<span id="cb15-4"><a href=""></a>  <span class="at">R_target =</span> <span class="fl">1.5</span></span>
<span id="cb15-5"><a href=""></a>)</span>
<span id="cb15-6"><a href=""></a>ngm_fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="apply-vaccination" class="slide level2">
<h2>Apply Vaccination</h2>
<ul>
<li class="fragment"><p>Applies the effect of vaccination on the next generation of infections, to understand and describe the reduction of acquisition and transmission in each age group.</p></li>
<li class="fragment"><p>Takes the following arguments:</p>
<ul>
<li class="fragment"><code>ngm</code> - a Next Generation Matrix</li>
<li class="fragment"><code>data</code> - A data frame with location specifics</li>
<li class="fragment">which columns are related to ‚Äúcoverage‚Äù, ‚Äúacquisition‚Äù, and ‚Äútransmission‚Äù in the <code>data</code> col</li>
</ul></li>
</ul>
</section>
<section id="example-vaccination-data" class="slide level2">
<h2>Example vaccination data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>vaccination_effect_example_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 17 √ó 4
   age_band coverage acquisition transmission
   &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
 1 0-4         0           0            0    
 2 5-11        0.782       0.583        0.254
 3 12-15       0.997       0.631        0.295
 4 16-19       0.965       0.786        0.469
 5 20-24       0.861       0.774        0.453
 6 25-29       0.997       0.778        0.458
 7 30-34       0.998       0.803        0.493
 8 35-39       0.998       0.829        0.533
 9 40-44       0.999       0.841        0.551
10 45-49       0.993       0.847        0.562
11 50-54       0.999       0.857        0.579
12 55-59       0.996       0.864        0.591
13 60-64       0.998       0.858        0.581
14 65-69       0.999       0.864        0.591
15 70-74       0.999       0.867        0.597
16 75-79       0.999       0.866        0.595
17 80+         0.999       0.844        0.556</code></pre>
</div>
</div>
<aside class="notes">
<p>I think they are the average vaccine efficacy (expressed as 1 minus the relative risk) over all vaccinated individuals in the population. I.e. we calculate an average form the number of people in that age group that have 1 dose, 2 doses, which brand, how long ago, etc.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="apply-vaccination-1" class="slide level2">
<h2>Apply vaccination</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>ngm_vacc_fairfield <span class="ot">&lt;-</span> <span class="fu">apply_vaccination</span>(</span>
<span id="cb18-2"><a href=""></a>  <span class="at">ngm =</span> ngm_fairfield,</span>
<span id="cb18-3"><a href=""></a>  <span class="at">data =</span> vaccination_effect_example_data,</span>
<span id="cb18-4"><a href=""></a>  <span class="at">coverage_col =</span> coverage,</span>
<span id="cb18-5"><a href=""></a>  <span class="at">acquisition_col =</span> acquisition,</span>
<span id="cb18-6"><a href=""></a>  <span class="at">transmission_col =</span> transmission</span>
<span id="cb18-7"><a href=""></a>)</span>
<span id="cb18-8"><a href=""></a></span>
<span id="cb18-9"><a href=""></a>ngm_vacc_fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="challenges-in-design" class="slide level2">
<h2>Challenges in Design</h2>
<ul>
<li class="fragment">Model fitting is fixed and rigid
<ul>
<li class="fragment">Although there are arguments for <code>age_break</code></li>
<li class="fragment">You cannot change the model formula (yet)</li>
</ul></li>
<li class="fragment">Design decision to provide access to fitting the model</li>
<li class="fragment">Tradeoff: <strong>easy to use</strong> vs <strong>more complex to create</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>synthetic_fairfield <span class="ot">&lt;-</span> <span class="fu">extrapolate_polymod</span>(</span>
<span id="cb19-2"><a href=""></a> <span class="at">population =</span> fairfield,</span>
<span id="cb19-3"><a href=""></a> <span class="at">age_breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">75</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="cn">Inf</span>)</span>
<span id="cb19-4"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="challenges-in-design-1" class="slide level2">
<h2>Challenges in Design</h2>
<ul>
<li class="fragment">Rigid design means easy to use at <strong>cost of flexibility</strong></li>
<li class="fragment">Specified variable names is fragile, but <strong>saves typing</strong></li>
<li class="fragment">Extra functions could always be added to be more flexible variants</li>
</ul>
</section>
<section id="future-directions" class="slide level2">
<h2>Future Directions</h2>
<ul>
<li class="fragment">Interface to changing GAM model terms or specify model</li>
<li class="fragment">Validating against Prem and other methods</li>
<li class="fragment">Allowing more flexible uses of other data sources (Separate out the Australian focus)</li>
<li class="fragment">Better automatic plotting (use of <code>autoplot</code>)</li>
</ul>
</section>
<section id="comment-software-vs-code" class="slide level2">
<h2>Comment: Software vs code</h2>
<ul>
<li class="fragment">Initial code was given as a <a href="https://gist.github.com/goldingn/85d2b7363d2da2888254bb6042144150">gist on github</a></li>
<li class="fragment">Turning the code into a package was greatly facilitated with <a href="https://github.com/yonicd/sinew">sinew</a> (<a href="https://github.com/njtierney/conmat/commit/48656e98b81273b90ec5c26eeec87eebd5f159ce#diff-46b25c6f5c66616a55c46eb2d3e236d1e4acc4e5b33f3dc934cabf7d1d396daa">sinew code</a>)</li>
<li class="fragment"><a href="https://github.com/njtierney/conmat/issues?q=is%3Aissue+is%3Aclosed">Github Issues are very useful</a></li>
<li class="fragment">Extra contributions can be implemented as <a href="https://github.com/njtierney/conmat/pulls?page=2&amp;q=is%3Apr+is%3Aclosed">pull requests</a> which can be tested with GH actions</li>
</ul>
</section>
<section id="comment-workflows" class="slide level2">
<h2>Comment: Workflows</h2>
<ul>
<li class="fragment">Also worked on a workflow for determining the impact of <a href="https://github.com/njtierney/ttiq-simulation">‚ÄúTest, Trace, Isolate, Quarantine‚Äù (TTIQ)</a></li>
<li class="fragment">Used <a href="https://books.ropensci.org/targets/">targets</a> R package to manage workflow - <a href="https://github.com/njtierney/ttiq-simulation/blob/master/_targets.R">file</a></li>
<li class="fragment">Allowed for many people to contribute to same code base (although a learning curve)</li>
<li class="fragment"><a href="https://github.com/njtierney/ttiq-simulation/tree/master/tests/testthat">Used tests, very useful for plots</a> with <a href="https://vdiffr.r-lib.org/">vdiffr</a> (<strong>example</strong>)</li>
<li class="fragment"><a href="https://github.com/njtierney/ttiq-simulation/issues?q=is%3Aissue+is%3Aclosed">Issues</a> helped facilitate task delivery/discussion</li>
<li class="fragment"><a href="https://github.com/njtierney/ttiq-simulation/pulls">Pull requests helped isolate issues</a></li>
</ul>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks</h1>
<ul>
<li class="fragment">Nick Golding</li>
<li class="fragment">Aarathy Babu</li>
<li class="fragment">Michael Lydeamore</li>
<li class="fragment">Chitra Saraswati</li>
</ul>
</section>

<section id="learning-more" class="title-slide slide level1 center">
<h1>Learning more</h1>
<svg viewbox="0 0 640 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#f0a800;" xmlns="http://www.w3.org/2000/svg">
<path d="M425.7 256c-16.9 0-32.8-9-41.4-23.4L320 126l-64.2 106.6c-8.7 14.5-24.6 23.5-41.5 23.5-4.5 0-9-.6-13.3-1.9L64 215v178c0 14.7 10 27.5 24.2 31l216.2 54.1c10.2 2.5 20.9 2.5 31 0L551.8 424c14.2-3.6 24.2-16.4 24.2-31V215l-137 39.1c-4.3 1.3-8.8 1.9-13.3 1.9zm212.6-112.2L586.8 41c-3.1-6.2-9.8-9.8-16.7-8.9L320 64l91.7 152.1c3.8 6.3 11.4 9.3 18.5 7.3l197.9-56.5c9.9-2.9 14.7-13.9 10.2-23.1zM53.2 41L1.7 143.8c-4.6 9.2.3 20.2 10.1 23l197.9 56.5c7.1 2 14.7-1 18.5-7.3L320 64 69.8 32.1c-6.9-.8-13.5 2.7-16.6 8.9z"></path>
</svg>
<p><a href="https://github.com/idem-lab/conmat">github.com/idem-lab/conmat</a></p>
<svg viewbox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#f0a800;" xmlns="http://www.w3.org/2000/svg">
<path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path>
</svg>
<p><a href="njtierney.github.io/conmat-tki-2024">njtierney.github.io/conmat-tki-2024</a></p>
<svg viewbox="0 0 496 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#f0a800;" xmlns="http://www.w3.org/2000/svg">
<path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>
</svg>
<p>njtierney</p>
<svg viewbox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;fill:#f0a800;" xmlns="http://www.w3.org/2000/svg">
<path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"></path>
</svg>
<p>nicholas.tierney@gmail.com</p>
</section>

<section id="end." class="title-slide slide level1 center">
<h1><strong>End.</strong></h1>

</section>

<section>
<section id="extras" class="title-slide slide level1 center">
<h1>Extras</h1>

</section>
<section id="how-does-the-model-work-1" class="slide level2">
<h2>How does the model work?</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>fit_single_contact_model <span class="ot">&lt;-</span> <span class="cf">function</span>(contact_data, population) {</span>
<span id="cb20-2"><a href=""></a></span>
<span id="cb20-3"><a href=""></a>  <span class="co"># programatically add the offset term to the formula, so the model defines</span></span>
<span id="cb20-4"><a href=""></a>  <span class="co"># information about the setting, without us having to pass it through to the</span></span>
<span id="cb20-5"><a href=""></a>  <span class="co"># prediction data</span></span>
<span id="cb20-6"><a href=""></a>  formula_no_offset <span class="ot">&lt;-</span> contacts <span class="sc">~</span></span>
<span id="cb20-7"><a href=""></a>    <span class="co"># deviation of contact age distribution from population age distribution</span></span>
<span id="cb20-8"><a href=""></a>    <span class="fu">s</span>(age_to) <span class="sc">+</span></span>
<span id="cb20-9"><a href=""></a>    <span class="co"># number of contacts by age</span></span>
<span id="cb20-10"><a href=""></a>    <span class="fu">s</span>(age_from) <span class="sc">+</span></span>
<span id="cb20-11"><a href=""></a>    <span class="co"># intergenerational contact patterns - enables the off-diagonals</span></span>
<span id="cb20-12"><a href=""></a>    <span class="fu">s</span>(<span class="fu">abs</span>(age_from <span class="sc">-</span> age_to)) <span class="sc">+</span></span>
<span id="cb20-13"><a href=""></a>    <span class="co"># interaction between intergenerational patterns and age_from, to remove</span></span>
<span id="cb20-14"><a href=""></a>    <span class="co"># ridge for some ages and settings</span></span>
<span id="cb20-15"><a href=""></a>    <span class="fu">s</span>(<span class="fu">abs</span>(age_from <span class="sc">-</span> age_to), age_from) <span class="sc">+</span></span>
<span id="cb20-16"><a href=""></a>    <span class="co"># probabilities of both attending (any) school/work</span></span>
<span id="cb20-17"><a href=""></a>    school_probability <span class="sc">+</span></span>
<span id="cb20-18"><a href=""></a>    work_probability</span>
<span id="cb20-19"><a href=""></a>  </span>
<span id="cb20-20"><a href=""></a>  <span class="co"># choose the offset variable based on the setting</span></span>
<span id="cb20-21"><a href=""></a>  setting <span class="ot">&lt;-</span> contact_data<span class="sc">$</span>setting[<span class="dv">1</span>]</span>
<span id="cb20-22"><a href=""></a>  offset_variable <span class="ot">&lt;-</span> <span class="cf">switch</span>(</span>
<span id="cb20-23"><a href=""></a>    setting,</span>
<span id="cb20-24"><a href=""></a>    <span class="at">school =</span> <span class="st">"log_contactable_population_school"</span>,</span>
<span id="cb20-25"><a href=""></a>    <span class="st">"log_contactable_population"</span></span>
<span id="cb20-26"><a href=""></a>  )</span>
<span id="cb20-27"><a href=""></a>  </span>
<span id="cb20-28"><a href=""></a>  <span class="co"># add multiplicative offset for population contactable, to enable</span></span>
<span id="cb20-29"><a href=""></a>  <span class="co"># extrapolation to new demographies</span></span>
<span id="cb20-30"><a href=""></a>  <span class="co"># in mgcv, this part of the offset gets used in prediction, which </span></span>
<span id="cb20-31"><a href=""></a>  <span class="co"># is what we want. Those are the "contactable" parts, which we use</span></span>
<span id="cb20-32"><a href=""></a>  <span class="co"># to extrapolate to new demographics.</span></span>
<span id="cb20-33"><a href=""></a>  formula_offset <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"~. + offset(%s)"</span>, offset_variable)</span>
<span id="cb20-34"><a href=""></a>  formula <span class="ot">&lt;-</span> <span class="fu">update</span>(formula_no_offset, formula_offset)</span>
<span id="cb20-35"><a href=""></a>  </span>
<span id="cb20-36"><a href=""></a>  <span class="co"># contact model for all locations together</span></span>
<span id="cb20-37"><a href=""></a>  contact_data <span class="sc">%&gt;%</span></span>
<span id="cb20-38"><a href=""></a>    <span class="fu">add_modelling_features</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-39"><a href=""></a>      <span class="co"># The modelling features added here are:</span></span>
<span id="cb20-40"><a href=""></a>        <span class="co"># the school and work offsets</span></span>
<span id="cb20-41"><a href=""></a>        <span class="co"># pop_age_to (interpolated population)</span></span>
<span id="cb20-42"><a href=""></a>        <span class="co"># `log_contactable_population_school`, and ` log_contactable_population`</span></span>
<span id="cb20-43"><a href=""></a>      population <span class="ot">=</span> population</span>
<span id="cb20-44"><a href=""></a>    mgcv<span class="sc">::</span><span class="fu">bam</span>(</span>
<span id="cb20-45"><a href=""></a>      <span class="at">formula =</span> formula,</span>
<span id="cb20-46"><a href=""></a>      <span class="at">family =</span> stats<span class="sc">::</span>poisson,</span>
<span id="cb20-47"><a href=""></a>      <span class="co"># add number of participants as a multilpicative offset here rather than in</span></span>
<span id="cb20-48"><a href=""></a>      <span class="co"># the formula, so it is not needed for prediction,</span></span>
<span id="cb20-49"><a href=""></a>      <span class="co"># </span><span class="al">NOTE</span><span class="co">: the offset of participants allows us to get the rate per person</span></span>
<span id="cb20-50"><a href=""></a>      <span class="at">offset =</span> <span class="fu">log</span>(participants),</span>
<span id="cb20-51"><a href=""></a>      <span class="at">data =</span> .</span>
<span id="cb20-52"><a href=""></a>    )</span>
<span id="cb20-53"><a href=""></a>  </span>
<span id="cb20-54"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="alt-approach-to-conmat-model" class="slide level2">
<h2>Alt approach to conmat model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># fit a model</span></span>
<span id="cb21-2"><a href=""></a><span class="fu">library</span>(conmat)</span>
<span id="cb21-3"><a href=""></a>fairfield_age_pop <span class="ot">&lt;-</span> <span class="fu">abs_age_lga</span>(<span class="st">"Fairfield (C)"</span>)</span>
<span id="cb21-4"><a href=""></a>fairfield_age_pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 √ó 4 (conmat_population)
 - age: lower.age.limit
 - population: population
   lga           lower.age.limit  year population
   &lt;chr&gt;                   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
 1 Fairfield (C)               0  2020      12261
 2 Fairfield (C)               5  2020      13093
 3 Fairfield (C)              10  2020      13602
 4 Fairfield (C)              15  2020      14323
 5 Fairfield (C)              20  2020      15932
 6 Fairfield (C)              25  2020      16190
 7 Fairfield (C)              30  2020      14134
 8 Fairfield (C)              35  2020      13034
 9 Fairfield (C)              40  2020      12217
10 Fairfield (C)              45  2020      13449
11 Fairfield (C)              50  2020      13419
12 Fairfield (C)              55  2020      13652
13 Fairfield (C)              60  2020      12907
14 Fairfield (C)              65  2020      10541
15 Fairfield (C)              70  2020       8227
16 Fairfield (C)              75  2020       5598
17 Fairfield (C)              80  2020       4006
18 Fairfield (C)              85  2020       4240</code></pre>
</div>
</div>
</section>
<section id="alt-approach-to-conmat-model-1" class="slide level2">
<h2>Alt approach to conmat model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>polymod_contact_data <span class="ot">&lt;-</span> <span class="fu">get_polymod_setting_data</span>()</span>
<span id="cb23-2"><a href=""></a>polymod_survey_data <span class="ot">&lt;-</span> <span class="fu">get_polymod_population</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="alt-approach-to-conmat-model-2" class="slide level2">
<h2>Alt approach to conmat model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a>setting_models <span class="ot">&lt;-</span> <span class="fu">fit_setting_contacts</span>(</span>
<span id="cb24-2"><a href=""></a>  <span class="at">contact_data_list =</span> polymod_contact_data,</span>
<span id="cb24-3"><a href=""></a>  <span class="at">population =</span> polymod_survey_data</span>
<span id="cb24-4"><a href=""></a>  )</span>
<span id="cb24-5"><a href=""></a></span>
<span id="cb24-6"><a href=""></a><span class="fu">str</span>(setting_models)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ home  :List of 54
  ..$ coefficients     : Named num [1:57] 0.617 -0.347 0.537 -68.875 4.169 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ db.drho          : num [1:55, 1:6] -0.00151 0.00455 0.00278 -0.91056 -0.334 ...
  ..$ gcv.ubre         : Named num 14790
  .. ..- attr(*, "names")= chr "fREML"
  ..$ mgcv.conv        :List of 2
  .. ..$ iter   : int 10
  .. ..$ message: chr "full convergence"
  ..$ rank             : int 55
  ..$ Ve               : num [1:57, 1:57] 0.001244 -0.000312 -0.003213 -0.075219 -0.013809 ...
  ..$ scale.estimated  : logi FALSE
  ..$ outer.info       :List of 4
  .. ..$ conv: chr "full convergence"
  .. ..$ iter: int 10
  .. ..$ grad: num [1:6] 7.09e-08 -1.92e-05 -1.44e-10 -4.01e-10 -1.35e-11 ...
  .. ..$ hess: num [1:6, 1:6] 3.50 3.76e-06 6.54e-03 -2.02e-02 -1.70e-03 ...
  ..$ optimizer        : chr [1:2] "perf" "newton"
  ..$ scale            : num 1
  ..$ sig2             : num 1
  ..$ sp               : Named num [1:6] 1.16e-03 1.03e+03 1.29e-01 2.06e-01 3.56e-02 ...
  .. ..- attr(*, "names")= chr [1:6] "s(gam_age_offdiag)" "s(gam_age_offdiag_2)" "s(gam_age_diag_prod)" "s(gam_age_diag_sum)" ...
  ..$ edf              : Named num [1:57] 1 1 1 0.903 0.976 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ edf1             : num [1:57] 1 1 1 0.989 0.995 ...
  ..$ edf2             : num [1:57] 1 1 1 1.08 0.975 ...
  ..$ hat              : num [1:57] 1 1 1 1 0.999 ...
  ..$ Vp               : num [1:57, 1:57] 0.001437 -0.000329 -0.00384 -0.097236 -0.017076 ...
  ..$ Vc               : num [1:57, 1:57] 0.001587 -0.000156 -0.004901 -0.10023 -0.016791 ...
  ..$ V.sp             : num [1:6, 1:6] 0.285793 -0.055921 0.001153 0.006059 0.000227 ...
  ..$ R                : num [1:57, 1:57] -117.23 72.94 8.84 -78.92 0 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : NULL
  ..$ iter             : int 8
  ..$ wt               : num [1:8787] 6.22 6.52 6.59 6.44 6.12 ...
  ..$ y                : int [1:8787] 10 7 12 14 12 6 8 9 6 6 ...
  ..$ prior.weights    : num [1:8787] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ assign           : int [1:3] 0 1 2
  ..$ boundary         : logi FALSE
  ..$ call             : language mgcv::bam(formula = formula, family = stats::poisson, data = ., offset = log(participants))
  ..$ cmX              : Named num [1:57] 1.00 3.86e-02 1.42e-01 -2.69e-14 -5.18e-15 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "" ...
  ..$ control          :List of 19
  .. ..$ nthreads    : num 1
  .. ..$ ncv.threads : num 1
  .. ..$ irls.reg    : num 0
  .. ..$ epsilon     : num 1e-07
  .. ..$ maxit       : num 200
  .. ..$ trace       : logi FALSE
  .. ..$ mgcv.tol    : num 1e-07
  .. ..$ mgcv.half   : num 15
  .. ..$ rank.tol    : num 1.49e-08
  .. ..$ nlm         :List of 6
  .. .. ..$ ndigit           : num 7
  .. .. ..$ gradtol          : num 1e-06
  .. .. ..$ stepmax          : num 2
  .. .. ..$ steptol          : num 1e-04
  .. .. ..$ iterlim          : num 200
  .. .. ..$ check.analyticals: logi FALSE
  .. ..$ optim       :List of 1
  .. .. ..$ factr: num 1e+07
  .. ..$ newton      :List of 5
  .. .. ..$ conv.tol: num 1e-06
  .. .. ..$ maxNstep: num 5
  .. .. ..$ maxSstep: num 2
  .. .. ..$ maxHalf : num 30
  .. .. ..$ use.svd : logi FALSE
  .. ..$ idLinksBases: logi TRUE
  .. ..$ scalePenalty: logi TRUE
  .. ..$ efs.lspmax  : num 15
  .. ..$ efs.tol     : num 0.1
  .. ..$ keepData    : logi FALSE
  .. ..$ scale.est   : chr "fletcher"
  .. ..$ edge.correct: logi FALSE
  ..$ converged        : logi TRUE
  ..$ data             : logi NA
  ..$ df.null          : int 8787
  ..$ df.residual      : num 8753
  ..$ family           :List of 13
  .. ..$ family    : chr "poisson"
  .. ..$ link      : chr "log"
  .. ..$ linkfun   :function (mu)  
  .. ..$ linkinv   :function (eta)  
  .. ..$ variance  :function (mu)  
  .. ..$ dev.resids:function (y, mu, wt)  
  .. ..$ aic       :function (y, n, mu, wt, dev)  
  .. ..$ mu.eta    :function (eta)  
  .. ..$ initialize:  expression({  if (any(y &lt; 0))  stop("negative values not allowed for the 'Poisson' family")  n &lt;- rep.int(1, nobs| __truncated__
  .. ..$ validmu   :function (mu)  
  .. ..$ valideta  :function (eta)  
  .. ..$ simulate  :function (object, nsim)  
  .. ..$ dispersion: num 1
  .. ..- attr(*, "class")= chr "family"
  ..$ formula          :Class 'formula'  language contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) +      s(gam_age_diag_sum) + s(gam_ag| __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ method           : chr "fREML"
  ..$ min.edf          : num 9
  ..$ model            :'data.frame':   8787 obs. of  11 variables:
  .. ..$ contacts                          : int [1:8787] 10 7 12 14 12 6 8 9 6 6 ...
  .. ..$ school_probability                : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ work_probability                  : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ offset(log_contactable_population): num [1:8787] -4.67 -4.66 -4.65 -4.63 -4.62 ...
  .. ..$ gam_age_offdiag                   : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_offdiag_2                 : num [1:8787] 0 1 4 9 16 25 36 49 64 81 ...
  .. ..$ gam_age_diag_prod                 : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ gam_age_diag_sum                  : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmax                      : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmin                      : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ (offset)                          : num [1:8787] 4.52 4.52 4.52 4.52 4.52 ...
  .. ..- attr(*, "terms")=Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "offset")= int 4
  .. .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. .. ..- attr(*, "intercept")= int 1
  .. .. .. ..- attr(*, "response")= int 1
  .. .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ nsdf             : int 3
  ..$ offset           : num [1:8787] -0.1527 -0.1387 -0.1246 -0.1105 -0.0964 ...
  ..$ pterms           :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population)
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:4, 1:2] 0 1 0 0 0 0 1 0
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:4] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)"
  .. .. .. .. ..$ : chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "term.labels")= chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "order")= int [1:2] 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "dataClasses")= Named chr [1:5] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:5] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ pred.formula     :Class 'formula'  language ~school_probability + work_probability + log_contactable_population + gam_age_offdiag +      gam_age_offdiag_2 + | __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ smooth           :List of 6
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 2.558 -0.769 4.813 -1.005 4.801 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -3.97e-06 -3.66e-06 -3.37e-06 -3.09e-06 -2.83e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -32 -31 -30 -29 -28 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 32
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.27e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag"
  .. .. ..$ first.para    : num 4
  .. .. ..$ last.para     : num 12
  .. .. ..$ first.sp      : num 1
  .. .. ..$ last.sp       : num 1
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.938 -0.423 -0.743 -0.413 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag_2"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag_2)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag_2)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 1.75 -1.68 -3.12 -2.03 3.03 ...
  .. .. ..$ UZ            : num [1:103, 1:10] 1.54e-12 1.54e-12 1.54e-12 1.53e-12 1.51e-12 ...
  .. .. ..$ Xu            : num [1:101, 1] -1533 -1532 -1529 -1524 -1517 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 1533
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.23e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag_2"
  .. .. ..$ first.para    : num 13
  .. .. ..$ last.para     : num 21
  .. .. ..$ first.sp      : num 2
  .. .. ..$ last.sp       : num 2
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.961 0.691 -0.87 0.676 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_prod"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_prod)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_prod)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.08 3.48 -8.2 -5.06 -7.78 ...
  .. .. ..$ UZ            : num [1:2002, 1:10] -2.38e-13 -2.37e-13 -2.37e-13 -2.36e-13 -2.36e-13 ...
  .. .. ..$ Xu            : num [1:2000, 1] -2152 -2150 -2149 -2146 -2145 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 2152
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.26e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_prod"
  .. .. ..$ first.para    : num 22
  .. .. ..$ last.para     : num 30
  .. .. ..$ first.sp      : num 3
  .. .. ..$ last.sp       : num 3
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.947 0.262 0.763 -0.162 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_sum"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_sum)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_sum)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.97 1.09 11.11 -1.66 -11.93 ...
  .. .. ..$ UZ            : num [1:193, 1:10] 4.62e-07 4.42e-07 4.23e-07 4.04e-07 3.85e-07 ...
  .. .. ..$ Xu            : num [1:191, 1] -93 -92 -91 -90 -89 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 93
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.88e-06
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_sum"
  .. .. ..$ first.para    : num 31
  .. .. ..$ last.para     : num 39
  .. .. ..$ first.sp      : num 4
  .. .. ..$ last.sp       : num 4
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.951 0.292 0.558 -0.351 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmax"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmax)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmax)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.151 -0.822 7.91 -1.089 8.153 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -4.38e-06 -4.04e-06 -3.72e-06 -3.41e-06 -3.12e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -62.5 -61.5 -60.5 -59.5 -58.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 62.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 1.7e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmax"
  .. .. ..$ first.para    : num 40
  .. .. ..$ last.para     : num 48
  .. .. ..$ first.sp      : num 5
  .. .. ..$ last.sp       : num 5
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.943 0.625 -0.705 0.621 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmin"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmin)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmin)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 3.642 0.732 6.581 -0.913 6.554 ...
  .. .. ..$ UZ            : num [1:93, 1:10] -6.87e-06 -6.26e-06 -5.67e-06 -5.11e-06 -4.59e-06 ...
  .. .. ..$ Xu            : num [1:91, 1] -30.5 -29.5 -28.5 -27.5 -26.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 30.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.24e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmin"
  .. .. ..$ first.para    : num 49
  .. .. ..$ last.para     : num 57
  .. .. ..$ first.sp      : num 6
  .. .. ..$ last.sp       : num 6
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.939 -0.671 -0.745 0.669 ...
  .. .. ..- attr(*, "nCons")= num 1
  ..$ terms            :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ var.summary      :List of 9
  .. ..$ school_probability        : num [1:3] 0 0.00147 0.90552
  .. ..$ work_probability          : num [1:3] 0 0.0183 0.58
  .. ..$ log_contactable_population: num [1:3] -9.34 -4.5 -4.16
  .. ..$ gam_age_offdiag           : num [1:3] 0 28 100
  .. ..$ gam_age_offdiag_2         : num [1:3] 0 784 10000
  .. ..$ gam_age_diag_prod         : num [1:3] 0 1596 9000
  .. ..$ gam_age_diag_sum          : num [1:3] 0 93 190
  .. ..$ gam_age_pmax              : num [1:3] 0 66 100
  .. ..$ gam_age_pmin              : num [1:3] 0 27 90
  ..$ weights          : num [1:8787] 6.22 6.52 6.59 6.44 6.12 ...
  ..$ xlevels          : Named list()
  ..$ NA.action        :function (object, ...)  
  ..$ linear.predictors: num [1:8787] 1.83 1.87 1.88 1.86 1.81 ...
  ..$ fitted.values    : num [1:8787] 6.22 6.52 6.59 6.44 6.12 ...
  ..$ residuals        : num [1:8787] 1.393 0.187 1.89 2.573 2.098 ...
  ..$ deviance         : num 10296
  ..$ aic              : num 26986
  ..$ null.deviance    : num 44061
  ..- attr(*, "class")= chr [1:4] "bam" "gam" "glm" "lm"
 $ work  :List of 54
  ..$ coefficients     : Named num [1:57] -9.56e-01 -3.50 2.16 4.35e-05 -7.51e-06 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ db.drho          : num [1:55, 1:6] 1.99e-07 -5.71e-06 -2.08e-06 -2.50e-04 -6.47e-05 ...
  ..$ gcv.ubre         : Named num 24356
  .. ..- attr(*, "names")= chr "fREML"
  ..$ mgcv.conv        :List of 2
  .. ..$ iter   : int 13
  .. ..$ message: chr "full convergence"
  ..$ rank             : int 55
  ..$ Ve               : num [1:57, 1:57] 1.16e-02 -6.12e-03 -1.49e-02 1.64e-07 -2.79e-07 ...
  ..$ scale.estimated  : logi FALSE
  ..$ outer.info       :List of 4
  .. ..$ conv: chr "full convergence"
  .. ..$ iter: int 13
  .. ..$ grad: num [1:6] -1.08e-04 6.46e-05 1.01e-05 -7.70e-06 -3.87e-06 ...
  .. ..$ hess: num [1:6, 1:6] 1.08e-04 -6.48e-05 -1.01e-05 7.75e-06 3.89e-06 ...
  ..$ optimizer        : chr [1:2] "perf" "newton"
  ..$ scale            : num 1
  ..$ sig2             : num 1
  ..$ sp               : Named num [1:6] 3.48e+03 9.06e-02 2.01e-02 8.45e-04 3.53e-03 ...
  .. ..- attr(*, "names")= chr [1:6] "s(gam_age_offdiag)" "s(gam_age_offdiag_2)" "s(gam_age_diag_prod)" "s(gam_age_diag_sum)" ...
  ..$ edf              : Named num [1:57] 1.00 1.00 1.00 -1.36e-05 2.30e-05 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ edf1             : num [1:57] 1.00 1.00 1.00 -1.18e-05 3.44e-05 ...
  ..$ edf2             : num [1:57] 1.00 1.00 1.00 3.16e-05 3.91e-05 ...
  ..$ hat              : num [1:57] 1 0.986 1 1 0.944 ...
  ..$ Vp               : num [1:57, 1:57] 2.12e-02 -6.60e-03 -1.73e-02 -5.76e-08 -4.47e-07 ...
  ..$ Vc               : num [1:57, 1:57] 2.87e-02 7.58e-03 -1.63e-02 -8.04e-07 -2.24e-07 ...
  ..$ V.sp             : num [1:6, 1:6] 9242.0084 0.3825 0.2028 -0.1229 -0.0125 ...
  ..$ R                : num [1:57, 1:57] -132 0 0 0 0 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : NULL
  ..$ iter             : int 11
  ..$ wt               : num [1:8787] 0.00929 0.01031 0.01129 0.01219 0.01302 ...
  ..$ y                : int [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  ..$ prior.weights    : num [1:8787] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ assign           : int [1:3] 0 1 2
  ..$ boundary         : logi FALSE
  ..$ call             : language mgcv::bam(formula = formula, family = stats::poisson, data = ., offset = log(participants))
  ..$ cmX              : Named num [1:57] 1.00 3.86e-02 1.42e-01 -2.69e-14 -5.18e-15 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "" ...
  ..$ control          :List of 19
  .. ..$ nthreads    : num 1
  .. ..$ ncv.threads : num 1
  .. ..$ irls.reg    : num 0
  .. ..$ epsilon     : num 1e-07
  .. ..$ maxit       : num 200
  .. ..$ trace       : logi FALSE
  .. ..$ mgcv.tol    : num 1e-07
  .. ..$ mgcv.half   : num 15
  .. ..$ rank.tol    : num 1.49e-08
  .. ..$ nlm         :List of 6
  .. .. ..$ ndigit           : num 7
  .. .. ..$ gradtol          : num 1e-06
  .. .. ..$ stepmax          : num 2
  .. .. ..$ steptol          : num 1e-04
  .. .. ..$ iterlim          : num 200
  .. .. ..$ check.analyticals: logi FALSE
  .. ..$ optim       :List of 1
  .. .. ..$ factr: num 1e+07
  .. ..$ newton      :List of 5
  .. .. ..$ conv.tol: num 1e-06
  .. .. ..$ maxNstep: num 5
  .. .. ..$ maxSstep: num 2
  .. .. ..$ maxHalf : num 30
  .. .. ..$ use.svd : logi FALSE
  .. ..$ idLinksBases: logi TRUE
  .. ..$ scalePenalty: logi TRUE
  .. ..$ efs.lspmax  : num 15
  .. ..$ efs.tol     : num 0.1
  .. ..$ keepData    : logi FALSE
  .. ..$ scale.est   : chr "fletcher"
  .. ..$ edge.correct: logi FALSE
  ..$ converged        : logi TRUE
  ..$ data             : logi NA
  ..$ df.null          : int 8787
  ..$ df.residual      : num 8755
  ..$ family           :List of 13
  .. ..$ family    : chr "poisson"
  .. ..$ link      : chr "log"
  .. ..$ linkfun   :function (mu)  
  .. ..$ linkinv   :function (eta)  
  .. ..$ variance  :function (mu)  
  .. ..$ dev.resids:function (y, mu, wt)  
  .. ..$ aic       :function (y, n, mu, wt, dev)  
  .. ..$ mu.eta    :function (eta)  
  .. ..$ initialize:  expression({  if (any(y &lt; 0))  stop("negative values not allowed for the 'Poisson' family")  n &lt;- rep.int(1, nobs| __truncated__
  .. ..$ validmu   :function (mu)  
  .. ..$ valideta  :function (eta)  
  .. ..$ simulate  :function (object, nsim)  
  .. ..$ dispersion: num 1
  .. ..- attr(*, "class")= chr "family"
  ..$ formula          :Class 'formula'  language contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) +      s(gam_age_diag_sum) + s(gam_ag| __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ method           : chr "fREML"
  ..$ min.edf          : num 9
  ..$ model            :'data.frame':   8787 obs. of  11 variables:
  .. ..$ contacts                          : int [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ school_probability                : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ work_probability                  : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ offset(log_contactable_population): num [1:8787] -4.67 -4.66 -4.65 -4.63 -4.62 ...
  .. ..$ gam_age_offdiag                   : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_offdiag_2                 : num [1:8787] 0 1 4 9 16 25 36 49 64 81 ...
  .. ..$ gam_age_diag_prod                 : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ gam_age_diag_sum                  : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmax                      : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmin                      : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ (offset)                          : num [1:8787] 4.52 4.52 4.52 4.52 4.52 ...
  .. ..- attr(*, "terms")=Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "offset")= int 4
  .. .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. .. ..- attr(*, "intercept")= int 1
  .. .. .. ..- attr(*, "response")= int 1
  .. .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ nsdf             : int 3
  ..$ offset           : num [1:8787] -0.1527 -0.1387 -0.1246 -0.1105 -0.0964 ...
  ..$ pterms           :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population)
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:4, 1:2] 0 1 0 0 0 0 1 0
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:4] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)"
  .. .. .. .. ..$ : chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "term.labels")= chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "order")= int [1:2] 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "dataClasses")= Named chr [1:5] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:5] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ pred.formula     :Class 'formula'  language ~school_probability + work_probability + log_contactable_population + gam_age_offdiag +      gam_age_offdiag_2 + | __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ smooth           :List of 6
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 2.558 -0.769 4.813 -1.005 4.801 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -3.97e-06 -3.66e-06 -3.37e-06 -3.09e-06 -2.83e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -32 -31 -30 -29 -28 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 32
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.27e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag"
  .. .. ..$ first.para    : num 4
  .. .. ..$ last.para     : num 12
  .. .. ..$ first.sp      : num 1
  .. .. ..$ last.sp       : num 1
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.938 -0.423 -0.743 -0.413 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag_2"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag_2)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag_2)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 1.75 -1.68 -3.12 -2.03 3.03 ...
  .. .. ..$ UZ            : num [1:103, 1:10] 1.54e-12 1.54e-12 1.54e-12 1.53e-12 1.51e-12 ...
  .. .. ..$ Xu            : num [1:101, 1] -1533 -1532 -1529 -1524 -1517 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 1533
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.23e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag_2"
  .. .. ..$ first.para    : num 13
  .. .. ..$ last.para     : num 21
  .. .. ..$ first.sp      : num 2
  .. .. ..$ last.sp       : num 2
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.961 0.691 -0.87 0.676 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_prod"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_prod)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_prod)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.08 3.48 -8.2 -5.06 -7.78 ...
  .. .. ..$ UZ            : num [1:2002, 1:10] -2.38e-13 -2.37e-13 -2.37e-13 -2.36e-13 -2.36e-13 ...
  .. .. ..$ Xu            : num [1:2000, 1] -2152 -2150 -2149 -2146 -2145 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 2152
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.26e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_prod"
  .. .. ..$ first.para    : num 22
  .. .. ..$ last.para     : num 30
  .. .. ..$ first.sp      : num 3
  .. .. ..$ last.sp       : num 3
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.947 0.262 0.763 -0.162 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_sum"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_sum)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_sum)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.97 1.09 11.11 -1.66 -11.93 ...
  .. .. ..$ UZ            : num [1:193, 1:10] 4.62e-07 4.42e-07 4.23e-07 4.04e-07 3.85e-07 ...
  .. .. ..$ Xu            : num [1:191, 1] -93 -92 -91 -90 -89 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 93
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.88e-06
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_sum"
  .. .. ..$ first.para    : num 31
  .. .. ..$ last.para     : num 39
  .. .. ..$ first.sp      : num 4
  .. .. ..$ last.sp       : num 4
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.951 0.292 0.558 -0.351 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmax"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmax)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmax)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.151 -0.822 7.91 -1.089 8.153 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -4.38e-06 -4.04e-06 -3.72e-06 -3.41e-06 -3.12e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -62.5 -61.5 -60.5 -59.5 -58.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 62.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 1.7e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmax"
  .. .. ..$ first.para    : num 40
  .. .. ..$ last.para     : num 48
  .. .. ..$ first.sp      : num 5
  .. .. ..$ last.sp       : num 5
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.943 0.625 -0.705 0.621 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmin"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmin)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmin)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 3.642 0.732 6.581 -0.913 6.554 ...
  .. .. ..$ UZ            : num [1:93, 1:10] -6.87e-06 -6.26e-06 -5.67e-06 -5.11e-06 -4.59e-06 ...
  .. .. ..$ Xu            : num [1:91, 1] -30.5 -29.5 -28.5 -27.5 -26.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 30.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.24e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmin"
  .. .. ..$ first.para    : num 49
  .. .. ..$ last.para     : num 57
  .. .. ..$ first.sp      : num 6
  .. .. ..$ last.sp       : num 6
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.939 -0.671 -0.745 0.669 ...
  .. .. ..- attr(*, "nCons")= num 1
  ..$ terms            :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ var.summary      :List of 9
  .. ..$ school_probability        : num [1:3] 0 0.00147 0.90552
  .. ..$ work_probability          : num [1:3] 0 0.0183 0.58
  .. ..$ log_contactable_population: num [1:3] -9.34 -4.5 -4.16
  .. ..$ gam_age_offdiag           : num [1:3] 0 28 100
  .. ..$ gam_age_offdiag_2         : num [1:3] 0 784 10000
  .. ..$ gam_age_diag_prod         : num [1:3] 0 1596 9000
  .. ..$ gam_age_diag_sum          : num [1:3] 0 93 190
  .. ..$ gam_age_pmax              : num [1:3] 0 66 100
  .. ..$ gam_age_pmin              : num [1:3] 0 27 90
  ..$ weights          : num [1:8787] 0.00929 0.01031 0.01129 0.01219 0.01302 ...
  ..$ xlevels          : Named list()
  ..$ NA.action        :function (object, ...)  
  ..$ linear.predictors: num [1:8787] -4.68 -4.57 -4.48 -4.41 -4.34 ...
  ..$ fitted.values    : num [1:8787] 0.00929 0.01031 0.01129 0.01219 0.01302 ...
  ..$ residuals        : num [1:8787] -0.136 -0.144 -0.15 -0.156 -0.161 ...
  ..$ deviance         : num 13263
  ..$ aic              : num 23512
  ..$ null.deviance    : num 48608
  ..- attr(*, "class")= chr [1:4] "bam" "gam" "glm" "lm"
 $ school:List of 54
  ..$ coefficients     : Named num [1:57] -7.622 -1.818 -0.255 -56.568 11.422 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ db.drho          : num [1:55, 1:6] 0.0468 0.0125 0.0408 -3.5456 -3.6435 ...
  ..$ gcv.ubre         : Named num 23077
  .. ..- attr(*, "names")= chr "fREML"
  ..$ mgcv.conv        :List of 2
  .. ..$ iter   : int 16
  .. ..$ message: chr "full convergence"
  ..$ rank             : int 55
  ..$ Ve               : num [1:57, 1:57] 1.28177 0.00594 0.01103 0.32637 0.04817 ...
  ..$ scale.estimated  : logi FALSE
  ..$ outer.info       :List of 4
  .. ..$ conv: chr "full convergence"
  .. ..$ iter: int 16
  .. ..$ grad: num [1:6] -1.24e-04 -9.10e-05 -5.40e-05 -5.08e-05 -3.23e-05 ...
  .. ..$ hess: num [1:6, 1:6] 3.014643 0.000124 0.15623 0.159387 0.092433 ...
  ..$ optimizer        : chr [1:2] "perf" "newton"
  ..$ scale            : num 1
  ..$ sig2             : num 1
  ..$ sp               : Named num [1:6] 1.10e-03 2.36e+01 6.19e-05 6.77e-06 7.52e-05 ...
  .. ..- attr(*, "names")= chr [1:6] "s(gam_age_offdiag)" "s(gam_age_offdiag_2)" "s(gam_age_diag_prod)" "s(gam_age_diag_sum)" ...
  ..$ edf              : Named num [1:57] 1 1 1 0.751 0.917 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ edf1             : num [1:57] 1 1 1 0.896 0.961 ...
  ..$ edf2             : num [1:57] 1 1 1 0.896 0.961 ...
  ..$ hat              : num [1:57] 1 1 1 1 1 ...
  ..$ Vp               : num [1:57, 1:57] 2.10274 0.00884 0.01803 0.50174 0.07166 ...
  ..$ Vc               : num [1:57, 1:57] 3.6672 0.0187 0.0399 -1.8361 -0.8078 ...
  ..$ V.sp             : num [1:6, 1:6] 0.3363 -0.4086 -0.04 -0.0356 -0.0176 ...
  ..$ R                : num [1:57, 1:57] -133.14 30.083 -25.536 -0.245 23.378 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : NULL
  ..$ iter             : int 19
  ..$ wt               : num [1:8787] 12.19 10.42 8.21 6.04 4.2 ...
  ..$ y                : int [1:8787] 13 4 2 1 1 3 0 0 0 0 ...
  ..$ prior.weights    : num [1:8787] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ assign           : int [1:3] 0 1 2
  ..$ boundary         : logi FALSE
  ..$ call             : language mgcv::bam(formula = formula, family = stats::poisson, data = ., offset = log(participants))
  ..$ cmX              : Named num [1:57] 1.00 3.86e-02 1.42e-01 -2.69e-14 -5.18e-15 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "" ...
  ..$ control          :List of 19
  .. ..$ nthreads    : num 1
  .. ..$ ncv.threads : num 1
  .. ..$ irls.reg    : num 0
  .. ..$ epsilon     : num 1e-07
  .. ..$ maxit       : num 200
  .. ..$ trace       : logi FALSE
  .. ..$ mgcv.tol    : num 1e-07
  .. ..$ mgcv.half   : num 15
  .. ..$ rank.tol    : num 1.49e-08
  .. ..$ nlm         :List of 6
  .. .. ..$ ndigit           : num 7
  .. .. ..$ gradtol          : num 1e-06
  .. .. ..$ stepmax          : num 2
  .. .. ..$ steptol          : num 1e-04
  .. .. ..$ iterlim          : num 200
  .. .. ..$ check.analyticals: logi FALSE
  .. ..$ optim       :List of 1
  .. .. ..$ factr: num 1e+07
  .. ..$ newton      :List of 5
  .. .. ..$ conv.tol: num 1e-06
  .. .. ..$ maxNstep: num 5
  .. .. ..$ maxSstep: num 2
  .. .. ..$ maxHalf : num 30
  .. .. ..$ use.svd : logi FALSE
  .. ..$ idLinksBases: logi TRUE
  .. ..$ scalePenalty: logi TRUE
  .. ..$ efs.lspmax  : num 15
  .. ..$ efs.tol     : num 0.1
  .. ..$ keepData    : logi FALSE
  .. ..$ scale.est   : chr "fletcher"
  .. ..$ edge.correct: logi FALSE
  ..$ converged        : logi TRUE
  ..$ data             : logi NA
  ..$ df.null          : int 8787
  ..$ df.residual      : num 8744
  ..$ family           :List of 13
  .. ..$ family    : chr "poisson"
  .. ..$ link      : chr "log"
  .. ..$ linkfun   :function (mu)  
  .. ..$ linkinv   :function (eta)  
  .. ..$ variance  :function (mu)  
  .. ..$ dev.resids:function (y, mu, wt)  
  .. ..$ aic       :function (y, n, mu, wt, dev)  
  .. ..$ mu.eta    :function (eta)  
  .. ..$ initialize:  expression({  if (any(y &lt; 0))  stop("negative values not allowed for the 'Poisson' family")  n &lt;- rep.int(1, nobs| __truncated__
  .. ..$ validmu   :function (mu)  
  .. ..$ valideta  :function (eta)  
  .. ..$ simulate  :function (object, nsim)  
  .. ..$ dispersion: num 1
  .. ..- attr(*, "class")= chr "family"
  ..$ formula          :Class 'formula'  language contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) +      s(gam_age_diag_sum) + s(gam_ag| __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ method           : chr "fREML"
  ..$ min.edf          : num 9
  ..$ model            :'data.frame':   8787 obs. of  11 variables:
  .. ..$ contacts                                 : int [1:8787] 13 4 2 1 1 3 0 0 0 0 ...
  .. ..$ school_probability                       : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ work_probability                         : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ offset(log_contactable_population_school): num [1:8787] -4.67 -4.66 -4.65 -4.63 -4.62 ...
  .. ..$ gam_age_offdiag                          : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_offdiag_2                        : num [1:8787] 0 1 4 9 16 25 36 49 64 81 ...
  .. ..$ gam_age_diag_prod                        : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ gam_age_diag_sum                         : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmax                             : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmin                             : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ (offset)                                 : num [1:8787] 4.52 4.52 4.52 4.52 4.52 ...
  .. ..- attr(*, "terms")=Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population_school) +      gam_age_offdi| __truncated__ ...
  .. .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school),      gam_age_offd| __truncated__ ...
  .. .. .. ..- attr(*, "offset")= int 4
  .. .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)" ...
  .. .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. .. ..- attr(*, "intercept")= int 1
  .. .. .. ..- attr(*, "response")= int 1
  .. .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school),      gam_age_offd| __truncated__ ...
  .. .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)" ...
  ..$ nsdf             : int 3
  ..$ offset           : num [1:8787] -0.1527 -0.1387 -0.1246 -0.1105 -0.0964 ...
  ..$ pterms           :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population_school)
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school))
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:4, 1:2] 0 1 0 0 0 0 1 0
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:4] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)"
  .. .. .. .. ..$ : chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "term.labels")= chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "order")= int [1:2] 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school))
  .. .. ..- attr(*, "dataClasses")= Named chr [1:5] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:5] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)" ...
  ..$ pred.formula     :Class 'formula'  language ~school_probability + work_probability + log_contactable_population_school +      gam_age_offdiag + gam_age_offdi| __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ smooth           :List of 6
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 2.558 -0.769 4.813 -1.005 4.801 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -3.97e-06 -3.66e-06 -3.37e-06 -3.09e-06 -2.83e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -32 -31 -30 -29 -28 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 32
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.27e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag"
  .. .. ..$ first.para    : num 4
  .. .. ..$ last.para     : num 12
  .. .. ..$ first.sp      : num 1
  .. .. ..$ last.sp       : num 1
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.938 -0.423 -0.743 -0.413 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag_2"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag_2)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag_2)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 1.75 -1.68 -3.12 -2.03 3.03 ...
  .. .. ..$ UZ            : num [1:103, 1:10] 1.54e-12 1.54e-12 1.54e-12 1.53e-12 1.51e-12 ...
  .. .. ..$ Xu            : num [1:101, 1] -1533 -1532 -1529 -1524 -1517 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 1533
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.23e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag_2"
  .. .. ..$ first.para    : num 13
  .. .. ..$ last.para     : num 21
  .. .. ..$ first.sp      : num 2
  .. .. ..$ last.sp       : num 2
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.961 0.691 -0.87 0.676 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_prod"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_prod)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_prod)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.08 3.48 -8.2 -5.06 -7.78 ...
  .. .. ..$ UZ            : num [1:2002, 1:10] -2.38e-13 -2.37e-13 -2.37e-13 -2.36e-13 -2.36e-13 ...
  .. .. ..$ Xu            : num [1:2000, 1] -2152 -2150 -2149 -2146 -2145 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 2152
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.26e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_prod"
  .. .. ..$ first.para    : num 22
  .. .. ..$ last.para     : num 30
  .. .. ..$ first.sp      : num 3
  .. .. ..$ last.sp       : num 3
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.947 0.262 0.763 -0.162 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_sum"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_sum)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_sum)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.97 1.09 11.11 -1.66 -11.93 ...
  .. .. ..$ UZ            : num [1:193, 1:10] 4.62e-07 4.42e-07 4.23e-07 4.04e-07 3.85e-07 ...
  .. .. ..$ Xu            : num [1:191, 1] -93 -92 -91 -90 -89 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 93
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.88e-06
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_sum"
  .. .. ..$ first.para    : num 31
  .. .. ..$ last.para     : num 39
  .. .. ..$ first.sp      : num 4
  .. .. ..$ last.sp       : num 4
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.951 0.292 0.558 -0.351 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmax"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmax)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmax)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.151 -0.822 7.91 -1.089 8.153 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -4.38e-06 -4.04e-06 -3.72e-06 -3.41e-06 -3.12e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -62.5 -61.5 -60.5 -59.5 -58.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 62.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 1.7e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmax"
  .. .. ..$ first.para    : num 40
  .. .. ..$ last.para     : num 48
  .. .. ..$ first.sp      : num 5
  .. .. ..$ last.sp       : num 5
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.943 0.625 -0.705 0.621 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmin"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmin)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmin)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 3.642 0.732 6.581 -0.913 6.554 ...
  .. .. ..$ UZ            : num [1:93, 1:10] -6.87e-06 -6.26e-06 -5.67e-06 -5.11e-06 -4.59e-06 ...
  .. .. ..$ Xu            : num [1:91, 1] -30.5 -29.5 -28.5 -27.5 -26.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 30.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.24e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmin"
  .. .. ..$ first.para    : num 49
  .. .. ..$ last.para     : num 57
  .. .. ..$ first.sp      : num 6
  .. .. ..$ last.sp       : num 6
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.939 -0.671 -0.745 0.669 ...
  .. .. ..- attr(*, "nCons")= num 1
  ..$ terms            :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population_school) +      gam_age_offdi| __truncated__ ...
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school),      gam_age_offd| __truncated__ ...
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)" ...
  .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population_school),      gam_age_offd| __truncated__ ...
  .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population_school)" ...
  ..$ var.summary      :List of 9
  .. ..$ school_probability               : num [1:3] 0 0.00147 0.90552
  .. ..$ work_probability                 : num [1:3] 0 0.0183 0.58
  .. ..$ log_contactable_population_school: num [1:3] -9.34 -4.5 -0.78
  .. ..$ gam_age_offdiag                  : num [1:3] 0 28 100
  .. ..$ gam_age_offdiag_2                : num [1:3] 0 784 10000
  .. ..$ gam_age_diag_prod                : num [1:3] 0 1596 9000
  .. ..$ gam_age_diag_sum                 : num [1:3] 0 93 190
  .. ..$ gam_age_pmax                     : num [1:3] 0 66 100
  .. ..$ gam_age_pmin                     : num [1:3] 0 27 90
  ..$ weights          : num [1:8787] 12.19 10.42 8.21 6.04 4.2 ...
  ..$ xlevels          : Named list()
  ..$ NA.action        :function (object, ...)  
  ..$ linear.predictors: num [1:8787] 2.5 2.34 2.11 1.8 1.43 ...
  ..$ fitted.values    : num [1:8787] 12.19 10.42 8.21 6.04 4.2 ...
  ..$ residuals        : num [1:8787] 0.228 -2.277 -2.604 -2.545 -1.877 ...
  ..$ deviance         : num 12770
  ..$ aic              : num 19174
  ..$ null.deviance    : num 133524
  ..- attr(*, "class")= chr [1:4] "bam" "gam" "glm" "lm"
 $ other :List of 54
  ..$ coefficients     : Named num [1:57] 0.926 -0.86 -1.082 40.002 -6.537 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ db.drho          : num [1:55, 1:6] 0.00142 -0.00374 -0.00655 4.02079 0.4178 ...
  ..$ gcv.ubre         : Named num 17677
  .. ..- attr(*, "names")= chr "fREML"
  ..$ mgcv.conv        :List of 2
  .. ..$ iter   : int 12
  .. ..$ message: chr "full convergence"
  ..$ rank             : int 55
  ..$ Ve               : num [1:57, 1:57] 0.003973 -0.000963 -0.004959 -0.024502 -0.001923 ...
  ..$ scale.estimated  : logi FALSE
  ..$ outer.info       :List of 4
  .. ..$ conv: chr "full convergence"
  .. ..$ iter: int 12
  .. ..$ grad: num [1:6] 2.94e-09 3.38e-09 -1.71e-10 -1.84e-10 -9.56e-11 ...
  .. ..$ hess: num [1:6, 1:6] 1.65562 0.13578 -0.00797 -0.01038 -0.00135 ...
  ..$ optimizer        : chr [1:2] "perf" "newton"
  ..$ scale            : num 1
  ..$ sig2             : num 1
  ..$ sp               : Named num [1:6] 1.05e-03 8.71e-04 2.78e-05 4.30e-06 1.03e-04 ...
  .. ..- attr(*, "names")= chr [1:6] "s(gam_age_offdiag)" "s(gam_age_offdiag_2)" "s(gam_age_diag_prod)" "s(gam_age_diag_sum)" ...
  ..$ edf              : Named num [1:57] 1 1 1 0.303 0.525 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "s(gam_age_offdiag).1" ...
  ..$ edf1             : num [1:57] 1 1 1 0.312 0.533 ...
  ..$ edf2             : num [1:57] 1 1 1 0.353 0.4 ...
  ..$ hat              : num [1:57] 1 1 1 1 1 ...
  ..$ Vp               : num [1:57, 1:57] 0.004087 -0.000984 -0.004991 -0.033431 -0.001424 ...
  ..$ Vc               : num [1:57, 1:57] 0.0042 -0.00106 -0.00505 0.02959 0.00869 ...
  ..$ V.sp             : num [1:6, 1:6] 0.607825 -0.046479 0.000519 0.00084 -0.000192 ...
  ..$ R                : num [1:57, 1:57] -145.1 87.9 26.7 -92.3 0 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : NULL
  .. .. ..$ : NULL
  ..$ iter             : int 9
  ..$ wt               : num [1:8787] 7.99 6.36 5.18 4.3 3.62 ...
  ..$ y                : int [1:8787] 7 7 11 11 5 5 4 4 2 3 ...
  ..$ prior.weights    : num [1:8787] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ assign           : int [1:3] 0 1 2
  ..$ boundary         : logi FALSE
  ..$ call             : language mgcv::bam(formula = formula, family = stats::poisson, data = ., offset = log(participants))
  ..$ cmX              : Named num [1:57] 1.00 3.86e-02 1.42e-01 -2.69e-14 -5.18e-15 ...
  .. ..- attr(*, "names")= chr [1:57] "(Intercept)" "school_probability" "work_probability" "" ...
  ..$ control          :List of 19
  .. ..$ nthreads    : num 1
  .. ..$ ncv.threads : num 1
  .. ..$ irls.reg    : num 0
  .. ..$ epsilon     : num 1e-07
  .. ..$ maxit       : num 200
  .. ..$ trace       : logi FALSE
  .. ..$ mgcv.tol    : num 1e-07
  .. ..$ mgcv.half   : num 15
  .. ..$ rank.tol    : num 1.49e-08
  .. ..$ nlm         :List of 6
  .. .. ..$ ndigit           : num 7
  .. .. ..$ gradtol          : num 1e-06
  .. .. ..$ stepmax          : num 2
  .. .. ..$ steptol          : num 1e-04
  .. .. ..$ iterlim          : num 200
  .. .. ..$ check.analyticals: logi FALSE
  .. ..$ optim       :List of 1
  .. .. ..$ factr: num 1e+07
  .. ..$ newton      :List of 5
  .. .. ..$ conv.tol: num 1e-06
  .. .. ..$ maxNstep: num 5
  .. .. ..$ maxSstep: num 2
  .. .. ..$ maxHalf : num 30
  .. .. ..$ use.svd : logi FALSE
  .. ..$ idLinksBases: logi TRUE
  .. ..$ scalePenalty: logi TRUE
  .. ..$ efs.lspmax  : num 15
  .. ..$ efs.tol     : num 0.1
  .. ..$ keepData    : logi FALSE
  .. ..$ scale.est   : chr "fletcher"
  .. ..$ edge.correct: logi FALSE
  ..$ converged        : logi TRUE
  ..$ data             : logi NA
  ..$ df.null          : int 8787
  ..$ df.residual      : num 8738
  ..$ family           :List of 13
  .. ..$ family    : chr "poisson"
  .. ..$ link      : chr "log"
  .. ..$ linkfun   :function (mu)  
  .. ..$ linkinv   :function (eta)  
  .. ..$ variance  :function (mu)  
  .. ..$ dev.resids:function (y, mu, wt)  
  .. ..$ aic       :function (y, n, mu, wt, dev)  
  .. ..$ mu.eta    :function (eta)  
  .. ..$ initialize:  expression({  if (any(y &lt; 0))  stop("negative values not allowed for the 'Poisson' family")  n &lt;- rep.int(1, nobs| __truncated__
  .. ..$ validmu   :function (mu)  
  .. ..$ valideta  :function (eta)  
  .. ..$ simulate  :function (object, nsim)  
  .. ..$ dispersion: num 1
  .. ..- attr(*, "class")= chr "family"
  ..$ formula          :Class 'formula'  language contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) +      s(gam_age_diag_sum) + s(gam_ag| __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ method           : chr "fREML"
  ..$ min.edf          : num 9
  ..$ model            :'data.frame':   8787 obs. of  11 variables:
  .. ..$ contacts                          : int [1:8787] 7 7 11 11 5 5 4 4 2 3 ...
  .. ..$ school_probability                : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ work_probability                  : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ offset(log_contactable_population): num [1:8787] -4.67 -4.66 -4.65 -4.63 -4.62 ...
  .. ..$ gam_age_offdiag                   : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_offdiag_2                 : num [1:8787] 0 1 4 9 16 25 36 49 64 81 ...
  .. ..$ gam_age_diag_prod                 : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ gam_age_diag_sum                  : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmax                      : num [1:8787] 0 1 2 3 4 5 6 7 8 9 ...
  .. ..$ gam_age_pmin                      : num [1:8787] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..$ (offset)                          : num [1:8787] 4.52 4.52 4.52 4.52 4.52 ...
  .. ..- attr(*, "terms")=Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "offset")= int 4
  .. .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. .. ..- attr(*, "intercept")= int 1
  .. .. .. ..- attr(*, "response")= int 1
  .. .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ nsdf             : int 3
  ..$ offset           : num [1:8787] -0.1527 -0.1387 -0.1246 -0.1105 -0.0964 ...
  ..$ pterms           :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population)
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:4, 1:2] 0 1 0 0 0 0 1 0
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:4] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)"
  .. .. .. .. ..$ : chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "term.labels")= chr [1:2] "school_probability" "work_probability"
  .. .. ..- attr(*, "order")= int [1:2] 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population))
  .. .. ..- attr(*, "dataClasses")= Named chr [1:5] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:5] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ pred.formula     :Class 'formula'  language ~school_probability + work_probability + log_contactable_population + gam_age_offdiag +      gam_age_offdiag_2 + | __truncated__ ...
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  ..$ smooth           :List of 6
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 2.558 -0.769 4.813 -1.005 4.801 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -3.97e-06 -3.66e-06 -3.37e-06 -3.09e-06 -2.83e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -32 -31 -30 -29 -28 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 32
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.27e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag"
  .. .. ..$ first.para    : num 4
  .. .. ..$ last.para     : num 12
  .. .. ..$ first.sp      : num 1
  .. .. ..$ last.sp       : num 1
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.938 -0.423 -0.743 -0.413 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_offdiag_2"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_offdiag_2)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_offdiag_2)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 1.75 -1.68 -3.12 -2.03 3.03 ...
  .. .. ..$ UZ            : num [1:103, 1:10] 1.54e-12 1.54e-12 1.54e-12 1.53e-12 1.51e-12 ...
  .. .. ..$ Xu            : num [1:101, 1] -1533 -1532 -1529 -1524 -1517 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 1533
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.23e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_offdiag_2"
  .. .. ..$ first.para    : num 13
  .. .. ..$ last.para     : num 21
  .. .. ..$ first.sp      : num 2
  .. .. ..$ last.sp       : num 2
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.961 0.691 -0.87 0.676 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_prod"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_prod)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_prod)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.08 3.48 -8.2 -5.06 -7.78 ...
  .. .. ..$ UZ            : num [1:2002, 1:10] -2.38e-13 -2.37e-13 -2.37e-13 -2.36e-13 -2.36e-13 ...
  .. .. ..$ Xu            : num [1:2000, 1] -2152 -2150 -2149 -2146 -2145 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 2152
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.26e-11
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_prod"
  .. .. ..$ first.para    : num 22
  .. .. ..$ last.para     : num 30
  .. .. ..$ first.sp      : num 3
  .. .. ..$ last.sp       : num 3
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.947 0.262 0.763 -0.162 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_diag_sum"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_diag_sum)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_diag_sum)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.97 1.09 11.11 -1.66 -11.93 ...
  .. .. ..$ UZ            : num [1:193, 1:10] 4.62e-07 4.42e-07 4.23e-07 4.04e-07 3.85e-07 ...
  .. .. ..$ Xu            : num [1:191, 1] -93 -92 -91 -90 -89 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 93
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.88e-06
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_diag_sum"
  .. .. ..$ first.para    : num 31
  .. .. ..$ last.para     : num 39
  .. .. ..$ first.sp      : num 4
  .. .. ..$ last.sp       : num 4
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 0.951 0.292 0.558 -0.351 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmax"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmax)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmax)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 4.151 -0.822 7.91 -1.089 8.153 ...
  .. .. ..$ UZ            : num [1:103, 1:10] -4.38e-06 -4.04e-06 -3.72e-06 -3.41e-06 -3.12e-06 ...
  .. .. ..$ Xu            : num [1:101, 1] -62.5 -61.5 -60.5 -59.5 -58.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 62.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 1.7e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmax"
  .. .. ..$ first.para    : num 40
  .. .. ..$ last.para     : num 48
  .. .. ..$ first.sp      : num 5
  .. .. ..$ last.sp       : num 5
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.943 0.625 -0.705 0.621 ...
  .. .. ..- attr(*, "nCons")= num 1
  .. ..$ :List of 29
  .. .. ..$ term          : chr "gam_age_pmin"
  .. .. ..$ bs.dim        : num 10
  .. .. ..$ fixed         : logi FALSE
  .. .. ..$ dim           : int 1
  .. .. ..$ p.order       : num 0
  .. .. ..$ by            : chr "NA"
  .. .. ..$ label         : chr "s(gam_age_pmin)"
  .. .. ..$ xt            : NULL
  .. .. ..$ id            : NULL
  .. .. ..$ sp            : Named num -1
  .. .. .. ..- attr(*, "names")= chr "s(gam_age_pmin)"
  .. .. ..$ drop.null     : num 0
  .. .. ..$ S             :List of 1
  .. .. .. ..$ : num [1:9, 1:9] 3.642 0.732 6.581 -0.913 6.554 ...
  .. .. ..$ UZ            : num [1:93, 1:10] -6.87e-06 -6.26e-06 -5.67e-06 -5.11e-06 -4.59e-06 ...
  .. .. ..$ Xu            : num [1:91, 1] -30.5 -29.5 -28.5 -27.5 -26.5 ...
  .. .. ..$ df            : num 9
  .. .. ..$ shift         : num [1(1d)] 30.5
  .. .. ..$ rank          : num 8
  .. .. ..$ null.space.dim: num 1
  .. .. ..$ plot.me       : logi TRUE
  .. .. ..$ side.constrain: logi TRUE
  .. .. ..$ repara        : logi TRUE
  .. .. ..$ C             : num 0
  .. .. ..$ S.scale       : num 2.24e-05
  .. .. ..$ Cp            : num 0
  .. .. ..$ vn            : chr "gam_age_pmin"
  .. .. ..$ first.para    : num 49
  .. .. ..$ last.para     : num 57
  .. .. ..$ first.sp      : num 6
  .. .. ..$ last.sp       : num 6
  .. .. ..- attr(*, "class")= chr [1:2] "tprs.smooth" "mgcv.smooth"
  .. .. ..- attr(*, "qrc")= 'sweepDrop' num [1:10] 9 -0.939 -0.671 -0.745 0.669 ...
  .. .. ..- attr(*, "nCons")= num 1
  ..$ terms            :Classes 'terms', 'formula'  language contacts ~ school_probability + work_probability + offset(log_contactable_population) +      gam_age_offdiag + ga| __truncated__ ...
  .. .. ..- attr(*, "variables")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "offset")= int 4
  .. .. ..- attr(*, "factors")= int [1:10, 1:8] 0 1 0 0 0 0 0 0 0 0 ...
  .. .. .. ..- attr(*, "dimnames")=List of 2
  .. .. .. .. ..$ : chr [1:10] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  .. .. .. .. ..$ : chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "term.labels")= chr [1:8] "school_probability" "work_probability" "gam_age_offdiag" "gam_age_offdiag_2" ...
  .. .. ..- attr(*, "order")= int [1:8] 1 1 1 1 1 1 1 1
  .. .. ..- attr(*, "intercept")= int 1
  .. .. ..- attr(*, "response")= int 1
  .. .. ..- attr(*, ".Environment")=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, "predvars")= language list(contacts, school_probability, work_probability, offset(log_contactable_population),      gam_age_offdiag, ga| __truncated__ ...
  .. .. ..- attr(*, "dataClasses")= Named chr [1:11] "numeric" "numeric" "numeric" "numeric" ...
  .. .. .. ..- attr(*, "names")= chr [1:11] "contacts" "school_probability" "work_probability" "offset(log_contactable_population)" ...
  ..$ var.summary      :List of 9
  .. ..$ school_probability        : num [1:3] 0 0.00147 0.90552
  .. ..$ work_probability          : num [1:3] 0 0.0183 0.58
  .. ..$ log_contactable_population: num [1:3] -9.34 -4.5 -4.16
  .. ..$ gam_age_offdiag           : num [1:3] 0 28 100
  .. ..$ gam_age_offdiag_2         : num [1:3] 0 784 10000
  .. ..$ gam_age_diag_prod         : num [1:3] 0 1596 9000
  .. ..$ gam_age_diag_sum          : num [1:3] 0 93 190
  .. ..$ gam_age_pmax              : num [1:3] 0 66 100
  .. ..$ gam_age_pmin              : num [1:3] 0 27 90
  ..$ weights          : num [1:8787] 7.99 6.36 5.18 4.3 3.62 ...
  ..$ xlevels          : Named list()
  ..$ NA.action        :function (object, ...)  
  ..$ linear.predictors: num [1:8787] 2.08 1.85 1.64 1.46 1.29 ...
  ..$ fitted.values    : num [1:8787] 7.99 6.36 5.18 4.3 3.62 ...
  ..$ residuals        : num [1:8787] -0.358 0.25 2.222 2.698 0.683 ...
  ..$ deviance         : num 14913
  ..$ aic              : num 33995
  ..$ null.deviance    : num 76245
  ..- attr(*, "class")= chr [1:4] "bam" "gam" "glm" "lm"
 - attr(*, "class")= chr [1:2] "setting_contact_model" "list"</code></pre>
</div>
</div>
</section>
<section id="alt-approach-to-conmat-model-3" class="slide level2">
<h2>Alt approach to conmat model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a>synthetic_settings_5y_fairfield <span class="ot">&lt;-</span> <span class="fu">predict_setting_contacts</span>(</span>
<span id="cb26-2"><a href=""></a>  <span class="at">population =</span> fairfield_age_pop,</span>
<span id="cb26-3"><a href=""></a>  <span class="at">contact_model =</span> setting_models,</span>
<span id="cb26-4"><a href=""></a>  <span class="at">age_breaks =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">85</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="cn">Inf</span>)</span>
<span id="cb26-5"><a href=""></a>  )</span>
<span id="cb26-6"><a href=""></a></span>
<span id="cb26-7"><a href=""></a>synthetic_settings_5y_fairfield</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section id="this-is-the-last-slide." class="title-slide slide level1 center">
<h1><strong>This is the last slide.</strong></h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>njtierney.github.io/conmat-tki-2024/</p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>